<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kids Collection | JAMEEL</title>

    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- âœ… USE YOUR SAME CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- TOP BAR --->
<div class="top-bar text-center fw-bold">
    COMPLIMENTARY NATIONWIDE DELIVERY ON ALL PRE-PAID ORDERS
</div>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top">
    <div class="container">
        <a class="navbar-brand" href="/">JAMEEL</a>

        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto text-uppercase">
                <li class="nav-item"><a class="nav-link" href="/women.html">Women</a></li>
                <li class="nav-item"><a class="nav-link" href="/men.html">Men</a></li>
                <li class="nav-item"><a class="nav-link active" href="/kids.html">Kids</a></li>
                <li class="nav-item"><a class="nav-link text-danger" href="#" onclick="filterProducts('Special Offer')">Sale</a></li>
            </ul>
        </div>

        <button class="btn border-0 position-relative" onclick="toggleCart()">
            <i class="fa fa-shopping-bag fa-lg"></i>
            <span class="badge bg-danger" id="cart-count">0</span>
        </button>
    </div>
</nav>

<!-- PAGE HEADER -->
<section class="py-5 bg-light text-center">
    <div class="container">
        <h1 class="section-title">Kids Collection</h1>
        <p class="text-muted mt-2">Comfortable & stylish outfits for kids</p>
    </div>
</section>

<!-- PRODUCTS -->
<section class="py-5">
    <div class="container">

        <!-- FILTERS -->
        <div class="filter-section mb-4 text-center">
            <button class="filter-btn active" data-filter="all" onclick="filterProducts('all')">ALL</button>
            <button class="filter-btn" onclick="filterSubCategory('1-Piece')">1-PIECE</button>
            <button class="filter-btn" onclick="filterSubCategory('2-Piece')">2-PIECE</button>
            <button class="filter-btn" onclick="filterSubCategory('3-Piece')">3-PIECE</button>
        </div>

        <!-- GRID -->
        <div id="product-grid" class="row">
            <div class="loading text-center py-5">
                <i class="fas fa-spinner fa-spin"></i>
                <p class="mt-3 text-muted">Loading kids products...</p>
            </div>
        </div>

    </div>
</section>

<!-- FOOTER -->
<footer class="bg-dark text-white py-4 text-center">
    <p class="mb-0 small">Â© 2026 JAMEEL. All Rights Reserved.</p>
</footer>

<!-- CART SIDEBAR (UNCHANGED STRUCTURE) -->
<div class="overlay" onclick="toggleCart()"></div>
<div id="cart-sidebar"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ===============================
   GLOBAL STATE
   =============================== */
let cart = [];
let allProducts = [];
let currentFilter = {
    category: 'all',
    subCategory: null,
    fabric: null
};

/* ===============================
   LOAD CART
   =============================== */
function loadCart() {
    const saved = localStorage.getItem('jameel_cart');
    if (saved) {
        cart = JSON.parse(saved);
        updateCartUI();
    }
}

/* ===============================
   LOAD PRODUCTS
   =============================== */
async function loadStore() {
    try {
        const res = await fetch(
            "https://api.github.com/repos/Subyyal/Jameelsclothingstore/contents/data/products"
        );
        const files = await res.json();
        allProducts = [];

        for (const file of files) {
            if (file.name.endsWith('.json')) {
                const r = await fetch(file.download_url);
                const item = await r.json();
                if (item.in_stock !== false) {
                    allProducts.push(item);
                }
            }
        }

        applyFilters();

    } catch (e) {
        document.getElementById('product-grid').innerHTML =
            '<div class="col-12 text-center text-muted py-5">Unable to load products</div>';
    }
}

/* ===============================
   DISPLAY PRODUCTS
   =============================== */
function displayProducts(products) {
    const grid = document.getElementById('product-grid');

    if (!products.length) {
        grid.innerHTML =
            '<div class="col-12 text-center text-muted py-5">No kids products found</div>';
        return;
    }

    grid.innerHTML = products.map(item => `
        <div class="col-6 col-md-3 product-card">
            <img src="${item.image}" class="w-100 mb-2" style="height:320px;object-fit:cover">
            <div class="product-title">${item.title}</div>
            <div class="product-price">Rs. ${item.price.toLocaleString()}</div>
        </div>
    `).join('');
}

/* ===============================
   FILTERS
   =============================== */
function filterProducts(category) {
    currentFilter.category = category;
    currentFilter.subCategory = null;
    applyFilters();
}

function filterSubCategory(subCat) {
    currentFilter.subCategory = subCat;
    applyFilters();
}

/* ===============================
   APPLY FILTERS (KIDS ONLY)
   =============================== */
function applyFilters() {
    let filtered = allProducts;

    // ðŸ”’ ONLY KIDS PRODUCTS
    filtered = filtered.filter(p => p.category === "Kids");

    if (currentFilter.subCategory) {
        filtered = filtered.filter(p => p.sub_category === currentFilter.subCategory);
    }

    displayProducts(filtered);
}

/* ===============================
   INIT
   =============================== */
loadCart();
loadStore();
</script>

</body>
</html>
